<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ - IP Expense Manager</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'><defs><linearGradient id='borderGrad' x1='0%' y1='0%' x2='100%' y2='100%'><stop offset='0%' stop-color='%238b5cf6'/><stop offset='50%' stop-color='%236d28d9'/><stop offset='100%' stop-color='%231e40af'/></linearGradient><linearGradient id='checkGrad' x1='0%' y1='0%' x2='100%' y2='100%'><stop offset='0%' stop-color='%23a78bfa'/><stop offset='100%' stop-color='%234f46e5'/></linearGradient><filter id='glow' x='-50%' y='-50%' width='200%' height='200%'><feGaussianBlur in='SourceGraphic' stdDeviation='1' result='blur'/><feMerge><feMergeNode in='blur'/><feMergeNode in='SourceGraphic'/></feMerge></filter></defs><circle cx='10' cy='10' r='9' fill='none' stroke='url(%23borderGrad)' stroke-width='1.5' opacity='0.9'/><path d='M6,10 L8.5,12.5 L14,7' stroke='url(%23checkGrad)' stroke-width='2.5' fill='none' stroke-linecap='round' stroke-linejoin='round' filter='url(%23glow)'/></svg>">
    
    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/components/navbar.css">
    <link rel="stylesheet" href="css/analytics.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="background-animation">
        <div class="gradient-circle circle-1"></div>
        <div class="gradient-circle circle-2"></div>
        <div class="gradient-circle circle-3"></div>
    </div>

    <!-- –ù–∞–≤–±–∞—Ä -->
    <nav class="main-navbar">
        <div class="navbar-container">
            <a href="dashboard.html" class="navbar-brand">
                <div class="brand-logo">üíº</div>
                <span class="brand-text">IP Expense Manager</span>
            </a>
            
            <button class="mobile-menu-btn">‚ò∞</button>
            
            <ul class="navbar-links">
                <li><a href="dashboard.html" class="nav-link"><span class="nav-icon">üìä</span> –î–∞—à–±–æ—Ä–¥</a></li>
                <li><a href="tasks.html" class="nav-link"><span class="nav-icon">üìã</span> –ó–∞–¥–∞—á–∏</a></li>
                <li><a href="templates.html" class="nav-link"><span class="nav-icon">üéØ</span> –®–∞–±–ª–æ–Ω—ã</a></li>
                <li><a href="cards.html" class="nav-link"><span class="nav-icon">üí≥</span> –ö–∞—Ä—Ç—ã</a></li>
                <li><a href="analytics.html" class="nav-link active"><span class="nav-icon">üìà</span> –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</a></li>
            </ul>
            
            <div class="user-menu">
                <div class="user-info">
                    <span class="user-name" id="userName">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>
                    <span class="user-role" id="userRole">–†–æ–ª—å</span>
                </div>
                <button onclick="logout()" class="logout-btn">
                    <span class="nav-icon">üö™</span>
                    –í—ã–π—Ç–∏
                </button>
            </div>
        </div>
    </nav>

    <main class="analytics-container">
        <div class="analytics-header">
            <div>
                <h1 class="page-title">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</h1>
                <p class="page-subtitle">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã –ø–æ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º</p>
            </div>
            <div class="export-actions">
                <button class="btn btn-secondary" onclick="exportToCSV()">
                    <span class="nav-icon">üì•</span>
                    –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
                </button>
            </div>
        </div>

        <!-- –§–∏–ª—å—Ç—Ä—ã -->
        <div class="analytics-filters">
            <div class="filter-group">
                <label class="filter-label" for="dateRange">–ü–µ—Ä–∏–æ–¥</label>
                <select class="filter-select" id="dateRange" onchange="updateCharts()">
                    <option value="7days">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π</option>
                    <option value="30days" selected>–ü–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π</option>
                    <option value="90days">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 90 –¥–Ω–µ–π</option>
                    <option value="year">–≠—Ç–æ—Ç –≥–æ–¥</option>
                    <option value="all">–ó–∞ –≤—Å–µ –≤—Ä–µ–º—è</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label class="filter-label" for="regionFilter">–†–µ–≥–∏–æ–Ω</label>
                <select class="filter-select" id="regionFilter" onchange="updateCharts()">
                    <option value="">–í—Å–µ —Ä–µ–≥–∏–æ–Ω—ã</option>
                    <option value="–ê—Å—Ç—Ä–∞—Ö–∞–Ω—å">–ê—Å—Ç—Ä–∞—Ö–∞–Ω—å</option>
                    <option value="–ë—É—Ä—è—Ç–∏—è">–ë—É—Ä—è—Ç–∏—è</option>
                    <option value="–ö—É—Ä–≥–∞–Ω">–ö—É—Ä–≥–∞–Ω</option>
                    <option value="–ö–∞–ª–º—ã–∫–∏—è">–ö–∞–ª–º—ã–∫–∏—è</option>
                    <option value="–ú–æ—Ä–¥–æ–≤–∏—è">–ú–æ—Ä–¥–æ–≤–∏—è</option>
                    <option value="–£–¥–º—É—Ä—Ç–∏—è">–£–¥–º—É—Ä—Ç–∏—è</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label class="filter-label" for="chartType">–¢–∏–ø –≥—Ä–∞—Ñ–∏–∫–∞</label>
                <select class="filter-select" id="chartType" onchange="updateChartTypes()">
                    <option value="bar">–°—Ç–æ–ª–±—á–∞—Ç—ã–µ</option>
                    <option value="line">–õ–∏–Ω–µ–π–Ω—ã–µ</option>
                    <option value="pie">–ö—Ä—É–≥–æ–≤—ã–µ</option>
                </select>
            </div>
        </div>

        <!-- KPI –ö–∞—Ä—Ç–æ—á–∫–∏ -->
        <div class="kpi-grid">
            <div class="kpi-card">
                <div class="kpi-value" id="totalExpensesKpi">0 ‚ÇΩ</div>
                <div class="kpi-label">–û–±—â–∏–µ —Ä–∞—Å—Ö–æ–¥—ã</div>
                <div class="kpi-trend trend-up" id="expensesTrend">‚Üë 12%</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-value" id="completedTasksKpi">0</div>
                <div class="kpi-label">–ó–∞–≤–µ—Ä—à–µ–Ω–æ –∑–∞–¥–∞—á</div>
                <div class="kpi-trend trend-up" id="tasksTrend">‚Üë 8%</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-value" id="activeIPsKpi">0</div>
                <div class="kpi-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö –ò–ü</div>
                <div class="kpi-trend trend-down" id="ipsTrend">‚Üì 3%</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-value" id="avgTaskCostKpi">0 ‚ÇΩ</div>
                <div class="kpi-label">–°—Ä–µ–¥–Ω–∏–π —á–µ–∫</div>
                <div class="kpi-trend trend-up" id="avgCostTrend">‚Üë 5%</div>
            </div>
        </div>

        <!-- –°–µ—Ç–∫–∞ –≥—Ä–∞—Ñ–∏–∫–æ–≤ -->
        <div class="charts-grid">
            <!-- –ì—Ä–∞—Ñ–∏–∫ —Ä–∞—Å—Ö–æ–¥–æ–≤ –ø–æ –º–µ—Å—è—Ü–∞–º -->
            <div class="chart-container">
                <div class="chart-header">
                    <h3 class="chart-title">–†–∞—Å—Ö–æ–¥—ã –ø–æ –º–µ—Å—è—Ü–∞–º</h3>
                    <div class="chart-actions">
                        <button class="btn-icon" onclick="downloadChart('expensesChart')" title="–°–∫–∞—á–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫">
                            üì•
                        </button>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <canvas id="expensesChart"></canvas>
                </div>
            </div>

            <!-- –ì—Ä–∞—Ñ–∏–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º -->
            <div class="chart-container">
                <div class="chart-header">
                    <h3 class="chart-title">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º</h3>
                    <div class="chart-actions">
                        <button class="btn-icon" onclick="downloadChart('regionsChart')" title="–°–∫–∞—á–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫">
                            üì•
                        </button>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <canvas id="regionsChart"></canvas>
                </div>
            </div>

            <!-- –ì—Ä–∞—Ñ–∏–∫ –ø–æ —Å—Ç–∞—Ç—å—è–º —Ä–∞—Å—Ö–æ–¥–æ–≤ -->
            <div class="chart-container">
                <div class="chart-header">
                    <h3 class="chart-title">–°—Ç–∞—Ç—å–∏ —Ä–∞—Å—Ö–æ–¥–æ–≤</h3>
                    <div class="chart-actions">
                        <button class="btn-icon" onclick="downloadChart('categoriesChart')" title="–°–∫–∞—á–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫">
                            üì•
                        </button>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <canvas id="categoriesChart"></canvas>
                </div>
            </div>

            <!-- –ì—Ä–∞—Ñ–∏–∫ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ -->
            <div class="chart-container">
                <div class="chart-header">
                    <h3 class="chart-title">–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤</h3>
                    <div class="chart-actions">
                        <button class="btn-icon" onclick="downloadChart('managersChart')" title="–°–∫–∞—á–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫">
                            üì•
                        </button>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <canvas id="managersChart"></canvas>
                </div>
            </div>
        </div>

        <!-- –°–µ–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞ -->
        <div class="export-section">
            <div class="export-header">
                <h3>–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</h3>
                <p>–í—ã –º–æ–∂–µ—Ç–µ –≤—ã–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞</p>
            </div>
            <div class="export-actions">
                <button class="btn btn-secondary" onclick="exportToCSV()">
                    <span class="nav-icon">üì•</span>
                    –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
                </button>
                <button class="btn btn-secondary" onclick="generatePDFReport()">
                    <span class="nav-icon">üìÑ</span>
                    PDF –æ—Ç—á–µ—Ç
                </button>
                <button class="btn btn-secondary" onclick="printCharts()">
                    <span class="nav-icon">üñ®Ô∏è</span>
                    –ü–µ—á–∞—Ç—å –æ—Ç—á–µ—Ç–æ–≤
                </button>
            </div>
        </div>
    </main>

    <script src="js/navbar.js"></script>
    <script src="js/analytics.js"></script>
</body>
</html>