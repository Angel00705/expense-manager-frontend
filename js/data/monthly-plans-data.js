// js/data/monthly-plans-data.js - ПОЛНАЯ ВЕРСИЯ
const MonthlyPlansData = {
    'Курган': {
        week1: {
            budget: 26000,
            reserve: 1500,
            total: 26000,
            tasks: [
                {
                    id: 'kurgan_week1_1',
                    category: 'salary',
                    description: 'Снятие наличных',
                    explanation: '',
                    ip: 'ИП Бондаренко',
                    card: '*7254',
                    plan: 3000,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week1_2',
                    category: 'products',
                    description: 'Кофе, чай, сахар, печенье',
                    explanation: '',
                    ip: 'ИП Бондаренко',
                    card: '*7254',
                    plan: 1500,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week1_3',
                    category: 'household',
                    description: 'Моющие средства, губки',
                    explanation: '',
                    ip: 'ИП Бобков',
                    card: '*2911',
                    plan: 2500,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week1_4',
                    category: 'medicaments',
                    description: 'Аптечка первой помощи',
                    explanation: '',
                    ip: 'ИП Овсейко',
                    card: '*1946',
                    plan: 1000,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week1_5',
                    category: 'stationery',
                    description: 'Ручки, блокноты, бумага',
                    explanation: '',
                    ip: 'ИП Федчук',
                    card: '*9967',
                    plan: 500,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week1_6',
                    category: 'azs',
                    description: 'Заправка автомобиля',
                    explanation: '',
                    ip: 'ИП Овсейко',
                    card: '*1946',
                    plan: 1000,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week1_7',
                    category: 'cafe',
                    description: 'Купить кофе/обед',
                    explanation: '',
                    ip: 'ИП Карбышев',
                    card: '*2937',
                    plan: 2000,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week1_8',
                    category: 'repairs',
                    description: 'Покупка штор',
                    explanation: 'на 2 окна гардины и тюли в Кургане',
                    ip: 'ИП Федчук',
                    card: '*9967',
                    plan: 5000,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week1_9',
                    category: 'salary',
                    description: 'за поездку и ремонт работы',
                    explanation: '-поездка в Курганская область, Мишкинский р-н, село Краснознаменское, ул.Мира, д.4, кв.6 -проверка почты у дома и в отделении почты. -Договориться с почтальоном чтобы писал когда есть письмо нам, взять контакт. -повесить шторы на 2 окнах',
                    ip: 'ИП Федчук',
                    card: '*9967',
                    plan: 8000,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week1_10',
                    category: 'repairs',
                    description: 'Починка Интернета в офисе',
                    explanation: '',
                    ip: '',
                    card: '',
                    plan: 1500,
                    fact: 0,
                    status: 'reserve',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                }
            ]
        },
        week2: {
            budget: 20300,
            reserve: 1500,
            total: 20300,
            tasks: [
                {
                    id: 'kurgan_week2_1',
                    category: 'salary',
                    description: 'Снятие наличных',
                    explanation: 'Есть смысл перенести на последнюю неделю',
                    ip: 'ИП Бобков',
                    card: '',
                    plan: 5000,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week2_2',
                    category: 'products',
                    description: 'Кофе, чай, сахар, печенье',
                    explanation: '',
                    ip: 'ИП Бондаренко',
                    card: '*7254',
                    plan: 1500,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week2_3',
                    category: 'household',
                    description: 'Бумажные полотенца, средства',
                    explanation: '',
                    ip: 'ИП Бобков',
                    card: '*2911',
                    plan: 2500,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week2_4',
                    category: 'polygraphy',
                    description: 'Распечатать фото',
                    explanation: '',
                    ip: 'ИП Бондаренко',
                    card: '*7254',
                    plan: 300,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week2_5',
                    category: 'events',
                    description: 'Купить билет в кино/театр',
                    explanation: 'сайт кинотеатра / фото билета в чат',
                    ip: 'ИП Овсейко',
                    card: '*1946',
                    plan: 1250,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week2_6',
                    category: 'repairs',
                    description: 'Купить и повесить занавески',
                    explanation: '',
                    ip: 'ИП Карбышев',
                    card: '*2937',
                    plan: 5000,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week2_7',
                    category: 'equipment',
                    description: 'МФУ для офиса',
                    explanation: '',
                    ip: 'ИП Бобков',
                    card: '',
                    plan: 0,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week2_8',
                    category: 'cleaning',
                    description: 'Мойка окон в офисе',
                    explanation: 'На р/с организации',
                    ip: 'ИП Овсейко',
                    card: '*1946',
                    plan: 2000,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week2_9',
                    category: 'shipping',
                    description: 'Упаковка посылок СДЭК',
                    explanation: '',
                    ip: '',
                    card: '',
                    plan: 1250,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week2_10',
                    category: 'repairs',
                    description: 'Починка Интернета в офисе',
                    explanation: '',
                    ip: '',
                    card: '',
                    plan: 1500,
                    fact: 0,
                    status: 'reserve',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                }
            ]
        },
        week3: {
            budget: 12500,
            reserve: 1500,
            total: 12500,
            tasks: [
                {
                    id: 'kurgan_week3_1',
                    category: 'salary',
                    description: 'Снятие наличных',
                    explanation: 'проставить суммы заранее',
                    ip: 'ИП Дюльгер',
                    card: '',
                    plan: 5000,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week3_2',
                    category: 'events',
                    description: 'кино/выставки/музеи',
                    explanation: '',
                    ip: 'ИП Овсейко',
                    card: '*1946',
                    plan: 1250,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week3_3',
                    category: 'repairs',
                    description: 'Ремонт дверного замка',
                    explanation: '',
                    ip: 'ИП Карбышев',
                    card: '',
                    plan: 3750,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week3_4',
                    category: 'azs',
                    description: 'Заправка автомобиля',
                    explanation: '',
                    ip: 'ИП Овсейко',
                    card: '*1946',
                    plan: 1000,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week3_5',
                    category: 'equipment',
                    description: 'Компьютерное оборудование',
                    explanation: '',
                    ip: '',
                    card: '',
                    plan: 0,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week3_6',
                    category: 'insurance',
                    description: '-',
                    explanation: '',
                    ip: '',
                    card: '',
                    plan: 0,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week3_7',
                    category: 'checks',
                    description: 'ул.Тобольная,54',
                    explanation: 'Бондаренко (Адрес офиса + напр. 2 чека по N руб)',
                    ip: '',
                    card: '',
                    plan: 0,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week3_8',
                    category: 'checks',
                    description: 'г. Курган, ул.Чехова 9, пом 11',
                    explanation: 'Федчук',
                    ip: '',
                    card: '',
                    plan: 0,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week3_9',
                    category: 'checks',
                    description: 'г. Курган, ул. Родионова 1А, 2 этаж, оф 23',
                    explanation: 'Карбышев',
                    ip: '',
                    card: '',
                    plan: 0,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week3_10',
                    category: 'checks',
                    description: 'г. Курган, ул. Карла Маркса, 106. оф.216',
                    explanation: 'Рябенко И.И.',
                    ip: '',
                    card: '',
                    plan: 0,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week3_11',
                    category: 'equipment',
                    description: '-',
                    explanation: '',
                    ip: '',
                    card: '',
                    plan: 0,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week3_12',
                    category: 'repairs',
                    description: 'Починка Интернета в офисе',
                    explanation: '',
                    ip: '',
                    card: '',
                    plan: 1500,
                    fact: 0,
                    status: 'reserve',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                }
            ]
        },
        week4: {
            budget: 13250,
            reserve: 1500,
            total: 13250,
            tasks: [
                {
                    id: 'kurgan_week4_1',
                    category: 'salary',
                    description: 'Снятие наличных',
                    explanation: '',
                    ip: 'ИП Федчук',
                    card: '',
                    plan: 5000,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week4_2',
                    category: 'repairs',
                    description: 'Финальные ремонтные работы',
                    explanation: '',
                    ip: 'ИП Бондаренко',
                    card: '',
                    plan: 5000,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week4_3',
                    category: 'household',
                    description: 'Оргтехника',
                    explanation: '',
                    ip: 'ИП Федчук',
                    card: '',
                    plan: 0,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week4_4',
                    category: 'equipment',
                    description: 'Финальные тех. закупки',
                    explanation: '',
                    ip: '',
                    card: '',
                    plan: 0,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week4_5',
                    category: 'stationery',
                    description: 'Ручки, блокноты, бумага',
                    explanation: '',
                    ip: 'ИП Федчук',
                    card: '*9967',
                    plan: 500,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week4_6',
                    category: 'shipping',
                    description: 'Финальные отправления',
                    explanation: '',
                    ip: '',
                    card: '',
                    plan: 1250,
                    fact: 0,
                    status: 'planned',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                },
                {
                    id: 'kurgan_week4_7',
                    category: 'repairs',
                    description: 'Починка Интернета в офисе',
                    explanation: '',
                    ip: '',
                    card: '',
                    plan: 1500,
                    fact: 0,
                    status: 'reserve',
                    dateCompleted: '',
                    responsible: 'Ксения Б.'
                }
            ]
        }
    },
    
    // ПУСТЫЕ ДАННЫЕ ДЛЯ ДРУГИХ РЕГИОНОВ
    'Астрахань': {
        week1: { budget: 0, reserve: 0, total: 0, tasks: [] },
        week2: { budget: 0, reserve: 0, total: 0, tasks: [] },
        week3: { budget: 0, reserve: 0, total: 0, tasks: [] },
        week4: { budget: 0, reserve: 0, total: 0, tasks: [] }
    },
    'Бурятия': {
        week1: { budget: 0, reserve: 0, total: 0, tasks: [] },
        week2: { budget: 0, reserve: 0, total: 0, tasks: [] },
        week3: { budget: 0, reserve: 0, total: 0, tasks: [] },
        week4: { budget: 0, reserve: 0, total: 0, tasks: [] }
    },
    'Калмыкия': {
        week1: { budget: 0, reserve: 0, total: 0, tasks: [] },
        week2: { budget: 0, reserve: 0, total: 0, tasks: [] },
        week3: { budget: 0, reserve: 0, total: 0, tasks: [] },
        week4: { budget: 0, reserve: 0, total: 0, tasks: [] }
    },
    'Мордовия': {
        week1: { budget: 0, reserve: 0, total: 0, tasks: [] },
        week2: { budget: 0, reserve: 0, total: 0, tasks: [] },
        week3: { budget: 0, reserve: 0, total: 0, tasks: [] },
        week4: { budget: 0, reserve: 0, total: 0, tasks: [] }
    },
    'Удмуртия': {
        week1: { budget: 0, reserve: 0, total: 0, tasks: [] },
        week2: { budget: 0, reserve: 0, total: 0, tasks: [] },
        week3: { budget: 0, reserve: 0, total: 0, tasks: [] },
        week4: { budget: 0, reserve: 0, total: 0, tasks: [] }
    }
};

// Функция для получения плана региона
function getMonthlyPlan(region) {
    return MonthlyPlansData[region] || { 
        week1: { budget: 0, reserve: 0, total: 0, tasks: [] },
        week2: { budget: 0, reserve: 0, total: 0, tasks: [] },
        week3: { budget: 0, reserve: 0, total: 0, tasks: [] },
        week4: { budget: 0, reserve: 0, total: 0, tasks: [] }
    };
}

// Функция для обновления задачи
function updateMonthlyTask(region, week, taskId, updates) {
    const weekKey = `week${week}`;
    const weekData = MonthlyPlansData[region]?.[weekKey];
    if (weekData && weekData.tasks) {
        const taskIndex = weekData.tasks.findIndex(task => task.id === taskId);
        if (taskIndex !== -1) {
            MonthlyPlansData[region][weekKey].tasks[taskIndex] = {
                ...MonthlyPlansData[region][weekKey].tasks[taskIndex],
                ...updates
            };
            // Сохраняем в localStorage
            localStorage.setItem('monthlyPlans', JSON.stringify(MonthlyPlansData));
            return true;
        }
    }
    return false;
}

// Инициализация данных для всех регионов
function initializeAllRegions() {
    const regions = ['Астрахань', 'Бурятия', 'Калмыкия', 'Мордовия', 'Удмуртия'];
    regions.forEach(region => {
        if (!MonthlyPlansData[region]) {
            MonthlyPlansData[region] = {
                week1: { budget: 0, reserve: 0, total: 0, tasks: [] },
                week2: { budget: 0, reserve: 0, total: 0, tasks: [] },
                week3: { budget: 0, reserve: 0, total: 0, tasks: [] },
                week4: { budget: 0, reserve: 0, total: 0, tasks: [] }
            };
        }
    });
}

// Вызываем инициализацию
initializeAllRegions();

// СДЕЛАЕМ ДАННЫЕ ГЛОБАЛЬНО ДОСТУПНЫМИ
window.MonthlyPlansData = MonthlyPlansData;
window.getMonthlyPlan = getMonthlyPlan;
window.updateMonthlyTask = updateMonthlyTask;

console.log('✅ MonthlyPlansData загружен:', Object.keys(MonthlyPlansData));