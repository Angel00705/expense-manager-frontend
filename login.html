<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Вход</title>
    <style>
        body { margin:0; padding:0; font-family:Arial; background:#3498db; display:flex; align-items:center; justify-content:center; min-height:100vh; }
        .login-box { background:white; padding:40px; border-radius:10px; width:400px; }
        input { width:100%; padding:12px; margin:10px 0; border:1px solid #ddd; border-radius:5px; }
        button { width:100%; padding:12px; background:#2ecc71; color:white; border:none; border-radius:5px; cursor:pointer; }
    </style>
</head>
<body>
    <div class="login-box">
        <h2>Expense Manager</h2>
        <form onsubmit="login(event)">
            <input type="email" id="email" placeholder="Email" value="admin@test.ru" required>
            <input type="password" id="password" placeholder="Пароль" value="123456" required>
            <button type="submit">Войти</button>
        </form>
        <div style="margin-top:20px; padding-top:20px; border-top:1px solid #eee; font-size:14px;">
            <strong>Тестовые аккаунты:</strong><br>
            admin@test.ru / 123456
        </div>
    </div>

    <script>
        async function login(event) {
            event.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const btn = event.target.querySelector('button');
            
            btn.disabled = true;
            btn.textContent = 'Вход...';
            
            try {
                const response = await fetch('https://expense-manager-backend-kq9h.onrender.com/api/auth/login', {
                    method: 'POST',
                    headers: {'Content-Type':'application/json'},
                    body: JSON.stringify({email, password})
                });
                
                const data = await response.json();
                
                if (data.token) {
                    localStorage.setItem('token', data.token);
                    localStorage.setItem('user', JSON.stringify(data.user));
                    window.location.href = 'dashboard.html';
                } else {
                    alert('Ошибка входа');
                }
            } catch (error) {
                alert('Ошибка: ' + error.message);
            }
            
            btn.disabled = false;
            btn.textContent = 'Войти';
        }
        
        // Проверка авторизации
        if (localStorage.getItem('token')) {
            window.location.href = 'dashboard.html';
        }
    </script>
</body>
</html>
