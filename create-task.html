<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É - Expense Manager</title>
    
    <!-- üé® FAVICON -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'><defs><linearGradient id='borderGrad' x1='0%' y1='0%' x2='100%' y2='100%'><stop offset='0%' stop-color='%238b5cf6'/><stop offset='50%' stop-color='%236d28d9'/><stop offset='100%' stop-color='%231e40af'/></linearGradient><linearGradient id='checkGrad' x1='0%' y1='0%' x2='100%' y2='100%'><stop offset='0%' stop-color='%23a78bfa'/><stop offset='100%' stop-color='%234f46e5'/></linearGradient><filter id='glow' x='-50%' y='-50%' width='200%' height='200%'><feGaussianBlur in='SourceGraphic' stdDeviation='1' result='blur'/><feMerge><feMergeNode in='blur'/><feMergeNode in='SourceGraphic'/></feMerge></filter></defs><circle cx='10' cy='10' r='9' fill='none' stroke='url(%23borderGrad)' stroke-width='1.5' opacity='0.9'/><path d='M6,10 L8.5,12.5 L14,7' stroke='url(%23checkGrad)' stroke-width='2.5' fill='none' stroke-linecap='round' stroke-linejoin='round' filter='url(%23glow)'/></svg>">
    
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/components.css">
    <link rel="stylesheet" href="./css/forms.css">
</head>
<body>
    <div class="dashboard-container">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="header-left">
                <a href="dashboard.html" class="back-link">‚Üê –ù–∞–∑–∞–¥ –∫ –¥–∞—à–±–æ—Ä–¥—É</a>
                <div class="logo">üí∞</div>
                <h1>–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</h1>
            </div>
            <div class="header-right">
                <span class="user-info" id="userInfo"></span>
                <button class="btn-secondary" onclick="window.location.href='dashboard.html'">–î–∞—à–±–æ—Ä–¥</button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="dashboard-main">
            <div class="form-container">
                <div class="form-header">
                    <h2>üìã –ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª—è—é—â–µ–≥–æ</h2>
                    <p>–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–ª–∞–Ω–∏—Ä—É–µ–º–æ–º —Ä–∞—Å—Ö–æ–¥–µ</p>
                </div>

                <form id="createTaskForm" class="task-form">
                    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –ò–ü -->
                    <div class="form-section">
                        <h3>üè¢ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –ò–ü</h3>
                        <div class="form-row">
                            <div class="input-group">
                                <label for="ipSelect" class="input-label">–í—ã–±–µ—Ä–∏—Ç–µ –ò–ü *</label>
                                <select id="ipSelect" class="form-select" required>
                                    <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –ò–ü --</option>
                                    <option value="ip1">–ò–ü "–í–æ—Å—Ç–æ–∫" (–ê—Å—Ç—Ä–∞—Ö–∞–Ω—å)</option>
                                    <option value="ip2">–ò–ü "–°–µ–≤–µ—Ä" (–ú–æ—Å–∫–≤–∞)</option>
                                    <option value="ip3">–ò–ü "–Æ–≥" (–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä)</option>
                                    <option value="ip4">–ò–ü "–ó–∞–ø–∞–¥" (–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥)</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label for="managerSelect" class="input-label">–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π —É–ø—Ä–∞–≤–ª—è—é—â–∏–π *</label>
                                <select id="managerSelect" class="form-select" required>
                                    <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —É–ø—Ä–∞–≤–ª—è—é—â–µ–≥–æ --</option>
                                    <option value="manager1">–ò–≤–∞–Ω–æ–≤ –ê.–°. (–ê—Å—Ç—Ä–∞—Ö–∞–Ω—å)</option>
                                    <option value="manager2">–ü–µ—Ç—Ä–æ–≤–∞ –ú.–ò. (–ú–æ—Å–∫–≤–∞)</option>
                                    <option value="manager3">–°–∏–¥–æ—Ä–æ–≤ –í.–ü. (–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä)</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞—Å—Ö–æ–¥–µ -->
                    <div class="form-section">
                        <h3>üí∞ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞—Å—Ö–æ–¥–µ</h3>
                        <div class="form-row">
                            <div class="input-group">
                                <label for="expenseItem" class="input-label">–°—Ç–∞—Ç—å—è —Ä–∞—Å—Ö–æ–¥–∞ *</label>
                                <select id="expenseItem" class="form-select" required>
                                    <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç–∞—Ç—å—é --</option>
                                    <option value="rent">–ê—Ä–µ–Ω–¥–∞ –ø–æ–º–µ—â–µ–Ω–∏—è</option>
                                    <option value="utilities">–ö–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏</option>
                                    <option value="salary">–ó–∞—Ä–∞–±–æ—Ç–Ω–∞—è –ø–ª–∞—Ç–∞</option>
                                    <option value="taxes">–ù–∞–ª–æ–≥–∏ –∏ —Å–±–æ—Ä—ã</option>
                                    <option value="marketing">–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥ –∏ —Ä–µ–∫–ª–∞–º–∞</option>
                                    <option value="supplies">–•–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</option>
                                    <option value="other">–ü—Ä–æ—á–∏–µ —Ä–∞—Å—Ö–æ–¥—ã</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label for="plannedAmount" class="input-label">–ü–ª–∞–Ω–æ–≤–∞—è —Å—É–º–º–∞ *</label>
                                <input type="number" id="plannedAmount" class="form-input" placeholder="0.00" min="0" step="0.01" required>
                            </div>
                        </div>
                        
                        <div class="input-group">
                            <label for="expenseDescription" class="input-label">–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–∞</label>
                            <textarea id="expenseDescription" class="form-textarea" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–ª–∞–Ω–∏—Ä—É–µ–º–æ–≥–æ —Ä–∞—Å—Ö–æ–¥–∞..." rows="3"></textarea>
                        </div>
                    </div>

                    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ–ø–ª–∞—Ç–µ -->
                    <div class="form-section">
                        <h3>üí≥ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ–ø–ª–∞—Ç–µ</h3>
                        <div class="form-row">
                            <div class="input-group">
                                <label for="paymentCard" class="input-label">–ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞ *</label>
                                <select id="paymentCard" class="form-select" required>
                                    <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç—É --</option>
                                    <option value="card1">**** 1234 (–¢–∏–Ω—å–∫–æ—Ñ—Ñ) - –û—Å–Ω–æ–≤–Ω–∞—è</option>
                                    <option value="card2">**** 5678 (–°–±–µ—Ä) - –†–µ–∑–µ—Ä–≤–Ω–∞—è</option>
                                    <option value="card3">**** 9012 (–ê–ª—å—Ñ–∞) - –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label for="plannedDate" class="input-label">–ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è –¥–∞—Ç–∞ –æ–ø–ª–∞—Ç—ã *</label>
                                <input type="date" id="plannedDate" class="form-input" required>
                            </div>
                        </div>
                    </div>

                    <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
                    <div class="form-section">
                        <h3>üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                        <div class="input-group">
                            <label for="taskComment" class="input-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è —É–ø—Ä–∞–≤–ª—è—é—â–µ–≥–æ</label>
                            <textarea id="taskComment" class="form-textarea" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏–ª–∏ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è..." rows="3"></textarea>
                        </div>
                    </div>

                    <!-- –ö–Ω–æ–ø–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ -->
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="window.location.href='dashboard.html'">–û—Ç–º–µ–Ω–∞</button>
                        <button type="submit" class="btn-primary btn-large">
                            <span class="btn-text">–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</span>
                            <div class="btn-loader" style="display: none;">
                                <div class="spinner"></div>
                            </div>
                        </button>
                    </div>
                </form>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            const token = localStorage.getItem('auth_token');
            const userEmail = localStorage.getItem('user_email');
            
            if (!token) {
                window.location.href = 'login.html';
                return;
            }

            document.getElementById('userInfo').textContent = userEmail;

            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–∞—Ç—ã - —Å–µ–≥–æ–¥–Ω—è
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('plannedDate').min = today;

            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã
            document.getElementById('createTaskForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = {
                    ip: document.getElementById('ipSelect').value,
                    manager: document.getElementById('managerSelect').value,
                    expenseItem: document.getElementById('expenseItem').value,
                    plannedAmount: document.getElementById('plannedAmount').value,
                    description: document.getElementById('expenseDescription').value,
                    paymentCard: document.getElementById('paymentCard').value,
                    plannedDate: document.getElementById('plannedDate').value,
                    comment: document.getElementById('taskComment').value
                };

                // –í–∞–ª–∏–¥–∞—Ü–∏—è
                if (!formData.ip || !formData.manager || !formData.expenseItem || !formData.plannedAmount || !formData.paymentCard || !formData.plannedDate) {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è');
                    return;
                }

                // –ò–º–∏—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏
                console.log('–°–æ–∑–¥–∞–Ω–∞ –∑–∞–¥–∞—á–∞:', formData);
                alert('‚úÖ –ó–∞–¥–∞—á–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞ –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∞ —É–ø—Ä–∞–≤–ª—è—é—â–µ–º—É!');
                window.location.href = 'tasks.html';
            });
        });
    </script>
</body>
</html>